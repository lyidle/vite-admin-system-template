import{az as N,aA as U,a as z,O as E,r as ee,o as oe,aB as te,f as p,s as C,y as o,w as t,j as T,h as w,g as k,k as l,P as h,aw as v,a5 as ae,E as le}from"./index-DpaPK14g.js";import{E as re}from"./el-dialog-CdQBEZHb.js";import"./el-overlay-Bqy0qcE3.js";import{E as ne,a as ie}from"./el-form-item-Utq6rYWC.js";import{A as se,u as de,E as me}from"./useElUpload-CYKOpwmv.js";import{_ as A}from"./plus-Bqin_PZf.js";/* empty css                 */import{E as pe}from"./el-card-jy9cJqIZ.js";import{E as ue}from"./el-pagination-gWFwAzPI.js";import{E as ce,a as _e,b as fe}from"./el-table-column-Om27YJSB.js";import{_ as ge,a as be}from"./edit-C5rcNmWR.js";import"./el-popover-B0UGxlQI.js";import{E as Ee}from"./el-button-C3BECGQo.js";import{e as ke}from"./index-DpgMtUJU.js";import{E as ve}from"./index-CKDBud7m.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./refs-DUQRGRFA.js";import"./vnode-wd0zXfV_.js";const Ue=(m,a)=>N.get(`${U.MANAGER+"/admin/product/baseTrademark/"+m}/${a}`),ye=m=>m.id?N.put(U.MANAGER+"/admin/product/baseTrademark/update",m):N.post(U.MANAGER+"/admin/product/baseTrademark/save",m),Te=m=>N.delete(U.MANAGER+"/admin/product/baseTrademark/remove/"+m),we={class:"container"},Ve=["src"],Ce=["src"],he=z({name:"TradeMark"}),Ae=z({...he,setup(m){const a=E({pageNo:1,limit:3,total:0,records:[]}),d=E({title:"",dialogFormVisible:!1});let r=E({logoUrl:"",tmName:""});function F(n,e,s){e.trim().length>=2?s():s(new Error("品牌名称需要大于等于两位~"))}function x(n,e,s){e?s():s(new Error("LOGO图片务必上传"))}let _=ee();const B=E({tmName:[{required:!0,trigger:"blur",validator:F}],logoUrl:[{required:!0,validator:x}]});async function u(n=1){a.pageNo=n;const e=await Ue(a.pageNo,a.limit);e.code===200&&(a.total=e.data.total,a.records=e.data.records.map(s=>({id:s.id,logoUrl:ke(s.logoUrl),tmName:s.tmName})))}function M(){u()}function O(){f(),d.title="添加品牌",d.dialogFormVisible=!0}function P(n){f(),d.title="修改品牌",d.dialogFormVisible=!0,r.id=n.id,r.tmName=n.tmName,r.logoUrl=n.logoUrl}function R(){f(),d.dialogFormVisible=!1}async function G(){await _.value.validate(),(await ye(r)).code===200?(d.dialogFormVisible=!1,v.success(r.id?"修改品牌成功":"添加品牌成功"),u(r.id?a.pageNo:1)):(d.dialogFormVisible=!1,v.error(r.id?"修改品牌失败":"添加品牌失败")),f()}const{beforeUpload:I}=de(),q=n=>{var e;r.logoUrl=n.data,(e=_.value)==null||e.clearValidate("logoUrl")};async function D(n){(await Te(n)).code===200?(v.success("删除品牌成功~"),u(a.records.length>1?a.pageNo:a.pageNo-1)):v.error("删除品牌失败")}function f(){r.id=void 0,r.logoUrl="",r.tmName="",ae(()=>{var n;(n=_.value)==null||n.clearValidate()})}return oe(()=>{u()}),(n,e)=>{const s=A,g=le,c=Ee,b=ce,$=ge,L=be,S=_e,j=fe,H=ue,X=pe,J=ve,V=ne,K=A,Q=me,W=ie,Y=re,y=te("hasButton");return p(),C("div",null,[o(X,null,{default:t(()=>[T("div",we,[w((p(),k(c,{type:"primary",onClick:O},{default:t(()=>[o(g,null,{default:t(()=>[o(s)]),_:1}),e[4]||(e[4]=T("span",{style:{"margin-left":"5px"}},"添加品牌",-1))]),_:1})),[[y,"btn.Trademark.add:添加品牌"]]),o(j,{style:{width:"100%"},border:"",data:l(a).records},{default:t(()=>[o(b,{type:"index",label:"序号",width:"80",align:"center"}),o(b,{prop:"tmName",label:"品牌名称",width:"width"}),o(b,{label:"品牌LOGO",width:"width"},{default:t(({row:i})=>[T("img",{src:i.logoUrl,alt:"",style:{width:"100px"}},null,8,Ve)]),_:1}),o(b,{prop:"prop",label:"品牌仓库",width:"width"},{default:t(({row:i})=>[w((p(),k(c,{type:"warning",size:"small",onClick:Z=>P(i)},{default:t(()=>[o(g,null,{default:t(()=>[o($)]),_:1})]),_:2},1032,["onClick"])),[[y,"btn.Trademark.update:修改品牌"]]),o(S,{title:`你确认要删除${i.tmName}么?`,onConfirm:Z=>D(i.id)},{reference:t(()=>[w((p(),k(c,{type:"danger",size:"small"},{default:t(()=>[o(g,null,{default:t(()=>[o(L)]),_:1})]),_:1})),[[y,"btn.Trademark.remove:删除品牌"]])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),o(H,{"current-page":l(a).pageNo,"onUpdate:currentPage":e[0]||(e[0]=i=>l(a).pageNo=i),"page-size":l(a).limit,"onUpdate:pageSize":e[1]||(e[1]=i=>l(a).limit=i),"page-sizes":[3,5,10],layout:"prev, pager, next,jumper,->,sizes,total",total:l(a).total,background:"",size:"small",onCurrentChange:u,onSizeChange:M},null,8,["current-page","page-size","total"])])]),_:1}),o(Y,{modelValue:l(d).dialogFormVisible,"onUpdate:modelValue":e[3]||(e[3]=i=>l(d).dialogFormVisible=i),title:l(d).title,width:"80%"},{footer:t(()=>[o(c,{type:"primary",onClick:R},{default:t(()=>e[5]||(e[5]=[h("取消")])),_:1}),o(c,{type:"primary",onClick:G},{default:t(()=>e[6]||(e[6]=[h("确定")])),_:1})]),default:t(()=>[o(W,{"label-width":"80",model:l(r),rules:l(B),ref_key:"formRef",ref:_},{default:t(()=>[o(V,{label:"品牌名称",prop:"tmName"},{default:t(()=>[o(J,{placeholder:"请您输入品牌名称",modelValue:l(r).tmName,"onUpdate:modelValue":e[2]||(e[2]=i=>l(r).tmName=i)},null,8,["modelValue"])]),_:1}),o(V,{label:"品牌LOGO",prop:"logoUrl"},{default:t(()=>[o(Q,{class:"avatar-uploader",action:l(se).fileUpload,"show-file-list":!1,"on-success":q,"before-upload":l(I)},{default:t(()=>[l(r).logoUrl?(p(),C("img",{key:0,src:l(r).logoUrl,class:"avatar"},null,8,Ce)):(p(),k(g,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[o(K)]),_:1}))]),_:1},8,["action","before-upload"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Je=Ne(Ae,[["__scopeId","data-v-5b6b29fe"]]);export{Je as default};
