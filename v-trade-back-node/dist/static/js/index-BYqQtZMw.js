import{ar as N,as as U,d as A,e as E,r as K,s as Q,at as W,o as u,c as w,f as t,w as a,h as p,a5 as y,A as k,g as l,i as C,E as v,R as Y,C as Z}from"./index-zCZRYDTo.js";import{E as ee}from"./el-dialog-DaNoymXH.js";import"./el-overlay-DpAhsVqO.js";import{E as ae,a as te}from"./el-form-item-ndx7fGQi.js";import{A as oe,u as le,E as re}from"./useElUpload-DJLQcGq1.js";/* empty css                 */import{E as ie}from"./el-card-BkJPws7M.js";import{E as se}from"./el-pagination-B65dXRP6.js";import{E as ne,a as de,b as me}from"./el-table-column-YrvKGUHw.js";import"./el-select-CQH5Taqg.js";import"./el-popover-_8Ap7mUU.js";import{E as pe}from"./el-button-feFDLJ41.js";import{e as ue}from"./index-DpgMtUJU.js";import{E as ce}from"./index-DlRGIAZ6.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./refs-cuhhTPoP.js";import"./vnode-Dy4NM1xu.js";const ge=(m,o)=>N.get(`${U.MANAGER+"/admin/product/baseTrademark/"+m}/${o}`),_e=m=>m.id?N.put(U.MANAGER+"/admin/product/baseTrademark/update",m):N.post(U.MANAGER+"/admin/product/baseTrademark/save",m),be=m=>N.delete(U.MANAGER+"/admin/product/baseTrademark/remove/"+m),Ee={class:"container"},ke=["src"],ve=["src"],Ne=A({name:"TradeMark"}),Ue=A({...Ne,setup(m){const o=E({pageNo:1,limit:3,total:0,records:[]}),d=E({title:"",dialogFormVisible:!1});let r=E({logoUrl:"",tmName:""});function F(i,e,s){e.trim().length>=2?s():s(new Error("品牌名称需要大于等于两位~"))}function z(i,e,s){e?s():s(new Error("LOGO图片务必上传"))}let g=K();const x=E({tmName:[{required:!0,trigger:"blur",validator:F}],logoUrl:[{required:!0,validator:z}]});async function c(i=1){o.pageNo=i;const e=await ge(o.pageNo,o.limit);e.code===200&&(o.total=e.data.total,o.records=e.data.records.map(s=>({id:s.id,logoUrl:ue(s.logoUrl),tmName:s.tmName})))}function R(){c()}function M(){_(),d.title="添加品牌",d.dialogFormVisible=!0}function B(i){_(),d.title="修改品牌",d.dialogFormVisible=!0,r.id=i.id,r.tmName=i.tmName,r.logoUrl=i.logoUrl}function G(){_(),d.dialogFormVisible=!1}async function I(){await g.value.validate(),(await _e(r)).code===200?(d.dialogFormVisible=!1,v.success(r.id?"修改品牌成功":"添加品牌成功"),c(r.id?o.pageNo:1)):(d.dialogFormVisible=!1,v.error(r.id?"修改品牌失败":"添加品牌失败")),_()}const{beforeUpload:O}=le(),h=i=>{var e;r.logoUrl=i.data,(e=g.value)==null||e.clearValidate("logoUrl")};async function q(i){(await be(i)).code===200?(v.success("删除品牌成功~"),c(o.records.length>1?o.pageNo:o.pageNo-1)):v.error("删除品牌失败")}function _(){r.id=void 0,r.logoUrl="",r.tmName="",Y(()=>{var i;(i=g.value)==null||i.clearValidate()})}return Q(()=>{c()}),(i,e)=>{const s=Z,f=pe,b=ne,P=de,$=me,D=se,L=ie,S=ce,V=ae,H=re,j=te,X=ee,T=W("hasButton");return u(),w("div",null,[t(L,null,{default:a(()=>[p("div",Ee,[y((u(),k(f,{type:"primary",onClick:M},{default:a(()=>[t(s,null,{default:a(()=>e[4]||(e[4]=[p("i",{class:"i-ep-plus"},null,-1)])),_:1}),e[5]||(e[5]=p("span",{style:{"margin-left":"5px"}},"添加品牌",-1))]),_:1})),[[T,"btn.Trademark.add:添加品牌"]]),t($,{style:{width:"100%"},border:"",data:l(o).records},{default:a(()=>[t(b,{type:"index",label:"序号",width:"80",align:"center"}),t(b,{prop:"tmName",label:"品牌名称",width:"width"}),t(b,{label:"品牌LOGO",width:"width"},{default:a(({row:n})=>[p("img",{src:n.logoUrl,alt:"",style:{width:"100px"}},null,8,ke)]),_:1}),t(b,{prop:"prop",label:"品牌仓库",width:"width"},{default:a(({row:n})=>[y((u(),k(f,{type:"warning",size:"small",onClick:J=>B(n)},{default:a(()=>[t(s,null,{default:a(()=>e[6]||(e[6]=[p("i",{class:"i-ep-edit"},null,-1)])),_:1})]),_:2},1032,["onClick"])),[[T,"btn.Trademark.update:修改品牌"]]),t(P,{title:`你确认要删除${n.tmName}么?`,onConfirm:J=>q(n.id)},{reference:a(()=>[y((u(),k(f,{type:"danger",size:"small"},{default:a(()=>[t(s,null,{default:a(()=>e[7]||(e[7]=[p("i",{class:"i-ep-delete"},null,-1)])),_:1})]),_:1})),[[T,"btn.Trademark.remove:删除品牌"]])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),t(D,{"current-page":l(o).pageNo,"onUpdate:currentPage":e[0]||(e[0]=n=>l(o).pageNo=n),"page-size":l(o).limit,"onUpdate:pageSize":e[1]||(e[1]=n=>l(o).limit=n),"page-sizes":[3,5,10],layout:"prev, pager, next,jumper,->,sizes,total",total:l(o).total,background:"",size:"small",onCurrentChange:c,onSizeChange:R},null,8,["current-page","page-size","total"])])]),_:1}),t(X,{modelValue:l(d).dialogFormVisible,"onUpdate:modelValue":e[3]||(e[3]=n=>l(d).dialogFormVisible=n),title:l(d).title,width:"80%"},{footer:a(()=>[t(f,{type:"primary",onClick:G},{default:a(()=>e[9]||(e[9]=[C("取消")])),_:1}),t(f,{type:"primary",onClick:I},{default:a(()=>e[10]||(e[10]=[C("确定")])),_:1})]),default:a(()=>[t(j,{"label-width":"80",model:l(r),rules:l(x),ref_key:"formRef",ref:g},{default:a(()=>[t(V,{label:"品牌名称",prop:"tmName"},{default:a(()=>[t(S,{placeholder:"请您输入品牌名称",modelValue:l(r).tmName,"onUpdate:modelValue":e[2]||(e[2]=n=>l(r).tmName=n)},null,8,["modelValue"])]),_:1}),t(V,{label:"品牌LOGO",prop:"logoUrl"},{default:a(()=>[t(H,{class:"avatar-uploader",action:l(oe).fileUpload,"show-file-list":!1,"on-success":h,"before-upload":l(O)},{default:a(()=>[l(r).logoUrl?(u(),w("img",{key:0,src:l(r).logoUrl,class:"avatar"},null,8,ve)):(u(),k(s,{key:1,class:"avatar-uploader-icon"},{default:a(()=>e[8]||(e[8]=[p("i",{class:"i-ep-plus"},null,-1)])),_:1}))]),_:1},8,["action","before-upload"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Pe=fe(Ue,[["__scopeId","data-v-592f59ab"]]);export{Pe as default};
